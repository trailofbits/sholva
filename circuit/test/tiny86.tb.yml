module: tiny86
file: ../../tiny86.v
inputs:
  - "560 step"
outputs:
  - "32 o_eax"
  - "32 o_ebx"
  - "32 o_ecx"
  - "32 o_edx"
  - "32 o_esi"
  - "32 o_edi"
  - "32 o_esp"
  - "32 o_ebp"
  - "32 o_eip"
  - "32 o_eflags"
vector_specs:
  - _description: "add EAX, EBX (eax=0x12345678, ebx=90abcdef)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010010001101000101011001111000100100001010101111001101111011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101110110110000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001101100000000001

    # OUTPUTS
    o_eax: 0xa2e02467
    o_ebx: 0x90abcdef
    o_esp: 0xffffddb0
    o_eip: 0x0804900c
    o_eflags: 658

  - _description: "mov EBX, EAX (eax=0xaaaaaaaa)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111110011010010100000000000000000000000000000000000000000000100000000100100100000000010100000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001100001110001001

    # OUTPUTS
    o_eax: 0xaaaaaaaa
    o_ebx: 0xaaaaaaaa
    o_esp: x
    o_eip: 0x08049007
    o_eflags: x

  - _description: "mov EAX, 0xaaaaaaaa (eip=0x8049000 / o_eip=eip + 5)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001110111010010110000000000000000000000000000000000000000100000000100100100000000000000000000000000000000001000000000100100001001000010010000100100001001000010010000100100001010101010101010101010101010101010111000

    # OUTPUTS
    o_eax: 0xaaaaaaaa
    o_esp: x
    o_eip: 0x8049005
    o_eflags: x

  - _description: "xchg EBX, EAX (eax=0xaaaaaaaa, ebx=0xbbbbbbbb)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010101010101010101010101110111011101110111011101110110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110110010111011000100000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000010010011

    # OUTPUTS
    o_eax: 0xbbbbbbbb
    o_ebx: 0xaaaaaaaa
    o_esp: x
    o_eip: 0x0804900b
    o_eflags: x

  - _description: "lea ecx, [(eax * 2) + ebx + 2] (eax=0xaaaaaaaa, ebx=0xbbbbbbbb)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010101010101010101010101110111011101110111011101110110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001110111010010110000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000000000010010000110100110010001101

    # OUTPUTS
    o_eax: 0xaaaaaaaa
    o_ebx: 0xbbbbbbbb
    o_ecx: 0x11111111
    o_esp: x
    o_eip: 0x0804900e
    o_eflags: x

  - _description: "rol eax, 8 (eax=0xaabbccdd)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101110111100110011011101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111011010010101100010000000000000000000000000000000000000000100000000100100100000000010100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000000010001100000011000001

    # OUTPUTS
    o_eax: 0xbbccddaa
    o_esp: x
    o_eip: x
    o_eflags: x

  - _description: "call 80490000 <sum> (rel32)"

    # INPUTS
    step: 0b10000110111111111100010110100100110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001011010010011000100111111111100010110100100110011000000100000000100100100000001010000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001111111111111111111111111110011111101000

    # OUTPUTS
    o_esp: 0xffc5a4c0 # esp(0xffc5a4c4) - 4
    o_ebp: 0xffc5a4cc
    o_eip: 0x8049000
    o_eflags: 2

  - _description: "call eax (eax=<add>) (indirect absolute)"

    # INPUTS
    step: 0b10000110111111111101100110010111011011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000001001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110110011001011101110000111111111101100110010111011110000000100000000100100100000100001100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001101000011111111

    # OUTPUTS
    o_eax: 0x08049000 # unchanged
    o_esp: x # TODO
    o_ebp: x # TODO
    o_eip: 0x08049000
    o_eflags: 2

  - _description: "jmp 804900a <done> (rel8)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110010001000111100000000000000000000000000000000000000000000100000000100100100000000010000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100000000010011101011

    # OUTPUTS
    o_esp: x
    o_eip: 0x804900a
    o_eflags: 2

  - _description: "cmpl $0xa,-0x4(%ebp) ([ebp-4]=11 < 10)"

    # INPUTS
    step: 0b10000010111111111111111111011001110010000000000000000000000000000000101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111001000111111111111111111011001110011000000100000000100100100000010001000000000000000000000000010000010100100001001000010010000100100001001000010010000100100001001000000001010111111000111110110000011

    # OUTPUTS
    o_eax: 0x0b
    o_edx: 0x05
    o_esp: 0xffffd9c8
    o_ebp: 0xffffd9cc
    o_eip: 0x08049026 # i_eip + 4
    o_eflags: 2 # all flags except reserved cleared

  - _description: "jle 8049039 <main+0x2c> (branch not taken)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000011111111110001010001101011111000111111111100010100011010111111000000100000000100100100000010011000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100000001000101111110

    # OUTPUTS
    o_eax: 0x0b
    o_edx: 0x05
    o_esp: x
    o_ebp: x
    o_eip: 0x08049028 # i_eip + 2
    o_eflags: 2

  - _description: "PUSH 2"

    # INPUTS
    step: 0b10000110111111111111111111011001101111000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111000000000000000000000000000000000000000000100000000100100100000000010100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100000000001001101010

    # OUTPUTS
    o_eax: 0x1 # unchanged
    o_esp: 0xffffd9bc # i_esp - 4
    o_eip: 0x08049007 # i_eip + 2
    o_eflags: 2 # unchanged

  - _description: "PUSH eax (eax=1)"

    # INPUTS
    step: 0b10000110111111111111111111011001101110000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110111100000000000000000000000000000000000000100000000100100100000000011100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000001010000

    # OUTPUTS
    o_eax: 0x1 # unchanged
    o_esp: 0xffffd9b8 # i_esp - 4
    o_eip: 0x08049008 # i_eip + 1
    o_eflags: 2 # unchanged

  - _description: "POP ebx ([esp]=1)"

    # INPUTS
    step: 0b10000010111111111111111111011001101110000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110111000000000000000000000000000000000000000100000000100100100000000100000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000001011011

    # OUTPUTS
    o_eax: 0x1 # unchanged
    o_ebx: 1
    o_esp: 0xffffd9bc # i_esp + 4
    o_eip: 0x08049009 # i_eip + 1
    o_eflags: 2 # unchanged

  - _description: "RET ([esp]=0x08049019 <main>)"

    # INPUTS
    step: 0b10000010111111111111111111011001110000000000100000000100100100000001100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111000000111111111111111111011001110011000000100000000100100100000000110000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000011000011

    # OUTPUTS
    o_eax: 0x7 # unchanged
    o_edx: 0x3 # unchanged
    o_esp: x # TODO 0xffffd9c4 # i_esp + 4
    o_ebp: 0xffffd9cc # unchanged
    o_eip: x # TODO 0x08049019
    o_eflags: 2 # unchanged
