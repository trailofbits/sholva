module: tiny86
file: ../../tiny86.v
inputs:
  - "560 step"
outputs:
  - "32 o_eax"
  - "32 o_ebx"
  - "32 o_ecx"
  - "32 o_edx"
  - "32 o_esi"
  - "32 o_edi"
  - "32 o_esp"
  - "32 o_ebp"
  - "32 o_eip"
  - "32 o_eflags"
vector_specs:
  - _description: "add EAX, EBX (eax=0x12345678, ebx=90abcdef)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010010001101000101011001111000100100001010101111001101111011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101110110110000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001101100000000001

    # OUTPUTS
    o_eax: 0xa2e02467
    o_ebx: 0x90abcdef
    o_esp: 0xffffddb0
    o_eip: 0x0804900c
    o_eflags: 658

  - _description: "mov EBX, EAX (eax=0xaaaaaaaa)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111110011010010100000000000000000000000000000000000000000000100000000100100100000000010100000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001100001110001001

    # OUTPUTS
    o_eax: 0xaaaaaaaa
    o_ebx: 0xaaaaaaaa
    o_esp: x
    o_eip: 0x08049007
    o_eflags: x

  - _description: "mov EAX, 0xaaaaaaaa (eip=0x8049000 / o_eip=eip + 5)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001110111010010110000000000000000000000000000000000000000100000000100100100000000000000000000000000000000001000000000100100001001000010010000100100001001000010010000100100001010101010101010101010101010101010111000

    # OUTPUTS
    o_eax: 0xaaaaaaaa
    o_esp: x
    o_eip: 0x8049005
    o_eflags: x

  - _description: "xchg EBX, EAX (eax=0xaaaaaaaa, ebx=0xbbbbbbbb)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010101010101010101010101110111011101110111011101110110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110110010111011000100000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000010010011

    # OUTPUTS
    o_eax: 0xbbbbbbbb
    o_ebx: 0xaaaaaaaa
    o_esp: x
    o_eip: 0x0804900b
    o_eflags: x

  - _description: "lea ecx, [(eax * 2) + ebx + 2] (eax=0xaaaaaaaa, ebx=0xbbbbbbbb)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010101010101010101010101110111011101110111011101110110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001110111010010110000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000000000010010000110100110010001101

    # OUTPUTS
    o_eax: 0xaaaaaaaa
    o_ebx: 0xbbbbbbbb
    o_ecx: 0x11111111
    o_esp: x
    o_eip: 0x0804900e
    o_eflags: x

  - _description: "rol eax, 8 (eax=0xaabbccdd)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101110111100110011011101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111011010010101100010000000000000000000000000000000000000000100000000100100100000000010100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000000010001100000011000001

    # OUTPUTS
    o_eax: 0xbbccddaa
    o_esp: x
    o_eip: x
    o_eflags: x

  - _description: "call 80490000 <sum> (rel32)"

    # INPUTS
    step: 0b10000110111111111100010110100100110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001011010010011000100111111111100010110100100110011000000100000000100100100000001010000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001111111111111111111111111110011111101000

    # OUTPUTS
    o_esp: x # TODO: 0xffd7b390
    o_ebp: x # TODO: 0xffd7b39c
    o_eip: 0x8049000
    o_eflags: 2
