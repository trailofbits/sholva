module: fetch
file: ../fetch.v
inputs:
  - "560 step"
outputs:
  - "96 raw_instr"
  - "32 eax"
  - "32 ebx"
  - "32 ecx"
  - "32 edx"
  - "32 esi"
  - "32 edi"
  - "32 esp"
  - "32 ebp"
  - "32 eip"
  - "32 eflags"
  - "72 raw_hint1"
  - "72 raw_hint2"
vector_specs:
  - _description: "basic step splitting"

    # INPUTS
    step: 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

    # OUTPUTS
    raw_instr: 0xffffffffffffffffffffffff
    eax: 0xffffffff
    ebx: 0xffffffff
    ecx: 0xffffffff
    edx: 0xffffffff
    esi: 0xffffffff
    edi: 0xffffffff
    esp: 0xffffffff
    ebp: 0xffffffff
    eip: 0xffffffff
    eflags: 0xffffffff
    raw_hint1: 0xffffffffffffffffff
    raw_hint2: 0xffffffffffffffffff

  - _description: "basic step splitting, with different values for clarity"

    # INPUTS
    step: 0xbbbbbbbbbbbbbbbbbbaaaaaaaaaaaaaaaaaaffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeeeeeeeeeeeeeeeeeeeeeeee

    # OUTPUTS
    eax: 0xffffffff
    ebx: 0xffffffff
    ecx: 0xffffffff
    edx: 0xffffffff
    esi: 0xffffffff
    edi: 0xffffffff
    esp: 0xffffffff
    ebp: 0xffffffff
    eip: 0xffffffff
    eflags: 0xffffffff
    raw_instr: 0xeeeeeeeeeeeeeeeeeeeeeeee
    raw_hint1: 0xbbbbbbbbbbbbbbbbbb
    raw_hint2: 0xaaaaaaaaaaaaaaaaaa

  - _description: "ADD eax, ebx (eax=0x12345678, ebx=0x90abcdef)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010010001101000101011001111000100100001010101111001101111011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101110110110000000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001101100000000001

    # OUTPUTS
    raw_instr: 0x90909090909090909090d801
    eax: 0x12345678
    ebx: 0x90abcdef
    esp: 0xffffddb0
    eip: 0x0804900a
    eflags: 0x00000202
  - _description: "ADD eax, [esp] ([esp]=0xaaaaaaaa, eax=0xbbbbbbbb)"

    # INPUTS
    step: 0b10000010111111111111111111011101101011001010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000010111011101110111011101110111011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101110110101100000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000001001000000010000000011

    # OUTPUTS
    raw_instr: 0x909090909090909090240403
    eax: 0xbbbbbbbb
    esp: 0xffffddac
    eip: 0x0804900a
    eflags: 0x00000202
    raw_hint1: 0x82ffffddacaaaaaaaa

  - _description: "ADD [esp], eax ([esp]=0xbbbbbbbb, eax=0xaaaaaaaa)"

    # INPUTS
    step: 0b10000010111111111111111111011101101011001011101110111011101110111011101110000110111111111111111111011101101011000110010101100110011001100110011010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101110110101100000000000000000000000000000000000000100000000100100100000000101000000000000000000000001000000010100100001001000010010000100100001001000010010000100100001001000010010000001001000000010000000001

    # OUTPUTS
    raw_instr: 0x909090909090909090240401
    eax: 0xaaaaaaaa
    esp: 0xffffddac
    eip: 0x804900a
    eflags: 0x00000202
    raw_hint1: 0x82ffffddacbbbbbbbb # read 0xbbbbbbbb
    raw_hint2: 0x86ffffddac65666666 # write 0x65666666

  - _description: "call 80490000 <sum> (rel32)"

    # INPUTS
    step: 0b10000110111111111100010110100100110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110001011010010011000100111111111100010110100100110011000000100000000100100100000001010000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001111111111111111111111111110011111101000

    # OUTPUTS
    raw_instr: 0x90909090909090ffffffe7e8
    esp: 0xffc5a4c4
    ebp: 0xffc5a4cc
    eip: 0x08049014
    eflags: 0x00000002
    raw_hint1: 0x86ffc5a4c000000000 # write

  - _description: "cmpl $0xa,-0x4(%ebp)"

    # INPUTS
    step: 0b10000010111111111111111111011001110010000000000000000000000000000000101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111001000111111111111111111011001110011000000100000000100100100000010001000000000000000000000000010000010100100001001000010010000100100001001000010010000100100001001000000001010111111000111110110000011

    # OUTPUTS
    raw_instr: 0x90909090909090900afc7d83
    eax: 0x0b
    edx: 0x05
    esp: 0xffffd9c8
    ebp: 0xffffd9cc
    eip: 0x08049022
    eflags: 0x00000082
    raw_hint1: 0x82ffffd9c80000000b # read

  - _description: "jle 8049039 <main+0x2c> (rel32)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000011111111110001010001101011111000111111111100010100011010111111000000100000000100100100000010011000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100000001000101111110

    # OUTPUTS
    raw_instr: 0x90909090909090909090117e
    eax: 0x0b
    edx: 0x05
    esp: 0xffc51af8
    ebp: 0xffc51afc
    eip: 0x08049026
    eflags: 0x00000002

  - _description: "PUSH 2"

    # INPUTS
    step: 0b10000110111111111111111111011001101111000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111000000000000000000000000000000000000000000100000000100100100000000010100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100000000001001101010

    # OUTPUTS
    raw_instr: 0x90909090909090909090026a
    eax: 0x1
    esp: 0xffffd9c0
    ebp: 0x00000000
    eip: 0x08049005
    eflags: 0x00000002
    raw_hint1: 0x86ffffd9bc00000002

  - _description: "POP ebx"

    # INPUTS
    step: 0b10000010111111111111111111011001101110000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110111000000000000000000000000000000000000000100000000100100100000000100000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000001011011

    # OUTPUTS
    raw_instr: 0x90909090909090909090905b
    eax: 0x1
    esp: 0xffffd9b8
    eip: 0x08049008
    eflags: 0x00000002
    raw_hint1: 0x82ffffd9b800000001

  - _description: "POP [ebx]"

    # INPUTS
    step: 0b10000110111111111111111111011001101111000000000000000000000000000000000110000010111111111111111111011001101110000000000000000000000000000000000100000000000000000000000000000000111111111111111111011001101111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110111000111111111111111111011001110000000000100000000100100100000000101100000000000000000000000010010010100100001001000010010000100100001001000010010000100100001001000010010000100100000000001110001111

    # OUTPUTS
    raw_instr: 0x90909090909090909090038f
    ebx: 0xffffd9bc
    esp: 0xffffd9b8
    ebp: 0xffffd9c0
    eip: 0x0804900b
    eflags: 0x00000092
    raw_hint1: 0x86ffffd9bc00000001
    raw_hint2: 0x82ffffd9b800000001

  - _description: "RET"

    # INPUTS
    step: 0b10000010111111111111111111011001110000000000100000000100100100000001100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111000000111111111111111111011001110011000000100000000100100100000000110000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000011000011

    # OUTPUTS
    raw_instr: 0x9090909090909090909090c3
    eax: 0x07
    edx: 0x03
    esp: 0xffffd9c0
    ebp: 0xffffd9cc
    eip: 0x0804900c
    eflags: 0x00000002
    raw_hint1: 0x82ffffd9c008049019

  - _description: "call eax (eax=0x08049000 <add>)"

    # INPUTS
    step: 0b10000110111111111101100110010111011011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000001001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111110110011001011101110000111111111101100110010111011110000000100000000100100100000100001100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001101000011111111

    # OUTPUTS
    raw_instr: 0x90909090909090909090d0ff
    eax: 0x08049000
    esp: 0xffd99770
    ebp: 0xffd99778
    eip: 0x08049043
    eflags: 0x00000002
    raw_hint1: 0x86ffd9976c00000000

  - _description: "LOOP <loop_begin> (ECX !=0, branch taken)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111100000000000000000000000000000000000000000100000000100100100000000110100000000000000000000000000000110100100001001000010010000100100001001000010010000100100001001000010010000100100001111101111100010

    # OUTPUTS
    raw_instr: 0x90909090909090909090fbe2
    eax: 0x9
    ecx: 2
    esp: 0xffffd9e0
    eip: 0x0804900d
    eflags: 0x00000006

  - _description: "LOOP <loop_begin> (ECX = 0, branch not taken)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111100000000000000000000000000000000000000000100000000100100100000000110100000000000000000000000000000110100100001001000010010000100100001001000010010000100100001001000010010000100100001111101111100010

    # OUTPUTS
    raw_instr: 0x90909090909090909090fbe2
    eax: 0xa
    ecx: 1
    esp: 0xffffd9e0
    eip: 0x0804900d
    eflags: 0x00000006

  - _description: "SUB ESP, 16"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111001100111111111111111111011001110011000000100000000100100100000000100000000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000000100001110110010000011

    # OUTPUTS
    raw_instr: 0x90909090909090909010ec83
    esp: 0xffffd9cc
    ebp: 0xffffd9cc
    eip: 0x08049008
    eflags: 0x00000002

  - _description: "MOV EAX, DWORD [EBP - 8]"

    # INPUTS
    step: 0b10000010111111111111111111011001110001000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110111100111111111111111111011001110011000000100000000100100100000010000000000000000000000000000010000010100100001001000010010000100100001001000010010000100100001001000010010000111110000100010110001011

    # OUTPUTS
    raw_instr: 0x909090909090909090f8458b
    esp: 0xffffd9bc
    ebp: 0xffffd9cc
    eip: 0x8049020
    eflags: 0x00000082
    raw_hint1: 0x82ffffd9c400000010

  - _description: "LEAVE"

    # INPUTS
    step: 0b10000010111111111111111111011001101010001111111111111111110110011011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110101000111111111111111111011001101010000000100000000100100100000100100000000000000000000000000010000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000011001001

    # OUTPUTS
    raw_instr: 0x9090909090909090909090c9
    eax: 5
    edx: 2
    esp: 0xffffd9a8
    ebp: 0xffffd9a8
    eip: 0x08049048
    eflags: 0x00000082
    raw_hint1: 0x82ffffd9a8ffffd9bc

  - _description: "mov eax, DWORD PTR [eax*4+0x804c000]"

    # INPUTS
    step: 0b10000010000010000000010011000000000000000000100000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110101000111111111111111111011001101010000000100000000100100100000011011000000000000000000000000000000010100100001001000010010000100100001001000000001000000001001100000000000000100001010000010010001011

    # OUTPUTS
    raw_instr: 0x90909090900804c00085048b
    esp: 0xffffd9a8
    ebp: 0xffffd9a8
    eip: 0x08049036
    eflags: 0x00000002
    raw_hint1: 0x820804c00008049000

  - _description: "sub eax, DWORD PTR [ebp+0xc] (2 - 3 = 4294967295)"

    # INPUTS
    step: 0b10000010111111111111111111011001101001000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110011000111111111111111111011001100110000000100000000100100100000001001100000000000000000000000010000010100100001001000010010000100100001001000010010000100100001001000010010000000011000100010100101011

    # OUTPUTS
    raw_instr: 0x9090909090909090900c452b
    eax: 2
    edx: 2
    esp: 0xffffd998
    ebp: 0xffffd998
    eip: 0x08049013
    eflags: 0x82
    raw_hint1: 0x82ffffd9a400000003

  - _description: "CDQ (EAX=-100)"

    # INPUTS
    step: 0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111110011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100111100000000000000000000000000000000000000000100000000100100100000000010100000000000000000000000000000010100100001001000010010000100100001001000010010000100100001001000010010000100100001001000010011001

    # OUTPUTS
    raw_instr: 0x909090909090909090909099
    eax: -100
    esp: 0xffffd9e0
    eip: 0x08049005
    eflags: 0x02

  - _description: "idiv DWORD PTR [ebp+0xc]"

    # INPUTS
    step: 0b10000010111111111111111111011001101001000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111101100110011000111111111111111111011001100110000000100000000100100100000010101100000000000000000000000010000010100100001001000010010000100100001001000010010000100100001001000010010000000011000111110111110111

    # OUTPUTS
    raw_instr: 0x9090909090909090900c7df7
    eax: 2
    esp: 0xffffd998
    ebp: 0xffffd998
    eip: 0x0804902b
    eflags: 0x82
    raw_hint1: 0x82ffffd9a400000003
