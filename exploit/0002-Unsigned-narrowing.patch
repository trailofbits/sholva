From 2e7f5a5557b3e8d95848ed4f9ef8388d98f1b440 Mon Sep 17 00:00:00 2001
From: Jack Leightcap <jack.leightcap@trailofbits.com>
Date: Thu, 13 Apr 2023 16:40:51 -0400
Subject: [PATCH 2/3] Unsigned narrowing

Signed-off-by: Jack Leightcap <jack.leightcap@trailofbits.com>
---
 hotspot/src/os/linux/vm/os_linux.cpp | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/hotspot/src/os/linux/vm/os_linux.cpp b/hotspot/src/os/linux/vm/os_linux.cpp
index 2d3880b3..1978f4d6 100644
--- a/hotspot/src/os/linux/vm/os_linux.cpp
+++ b/hotspot/src/os/linux/vm/os_linux.cpp
@@ -2016,7 +2016,13 @@ void * os::dll_load(const char *filename, char *ebuf, int ebuflen)
   // Identify compatability class for VM's architecture and library's architecture
   // Obtain string descriptions for architectures
 
-  arch_t lib_arch={elf_head.e_machine,0,elf_head.e_ident[EI_CLASS], elf_head.e_ident[EI_DATA], NULL};
+  arch_t lib_arch={
+    elf_head.e_machine,
+    0,
+    static_cast<char>(elf_head.e_ident[EI_CLASS]),
+    static_cast<char>(elf_head.e_ident[EI_DATA]),
+    NULL
+  };
   int running_arch_index=-1;
 
   for (unsigned int i=0 ; i < ARRAY_SIZE(arch_array) ; i++ ) {
-- 
2.38.4

